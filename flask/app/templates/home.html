<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=contact_emergency" />
    <link href="https://fonts.googleapis.com/css2?family=Pridi:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/home.css">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='ico/stock_logo.png') }}">
    <script type="text/javascript" src="../templates/js/darkmode.js" defer></script>
    <title>Home page</title>
</head>
<body class="lightmode en">
    <div class="top-bar">
        <div class="profile-wrapper">
            <div class="profile-circle">
                {% if current_user.profile_pic %}
                    <img src="{{ current_user.profile_pic }}"  class="profile-img">
                {% else %}
                    <div class="user-icon">{{ current_user.Fname[0].upper() }}</div>
                {% endif %}
            </div>
            <div class="profile-text">
                <span class="welcome-message">Welcome!<br></span>
                <span>{{ current_user.Fname}} {{ current_user.Lname }}</span>
            </div>
            <form>
                <input id="logout" type="button" value="logout">
            </form>
        </div>
        
        <div class="action-wrapper">
            <!-- <button id="language-switch">
                <span>TH</span>
                <span>EN</span>
            </button> -->

            <button id="theme-switch">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/></svg>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z"/></svg>
            </button>

            <div class="notification-circle notification">
                <a href="{{ url_for('notification') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M160-200v-80h80v-280q0-83 50-147.5T420-792v-28q0-25 17.5-42.5T480-880q25 0 42.5 17.5T540-820v28q80 20 130 84.5T720-560v280h80v80H160ZM480-80q-33 0-56.5-23.5T400-160h160q0 33-23.5 56.5T480-80Z"/></svg>            
                    <span class="notification-badge">3</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- <div class="search-container">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg>
        <input type="search" class="search-input" id="search-input" name="query" placeholder="Search">
    </div> -->
    
    <div class="category-container">
        <div class="category">
            <button class="circle-button circle-button-lightmode">
                <a href="{{ url_for('statistic') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M80-120v-80h800v80H80Zm40-120v-280h120v280H120Zm200 0v-480h120v480H320Zm200 0v-360h120v360H520Zm200 0v-600h120v600H720Z"/></svg>
                </a>
            </button>
            <span>Statistics</span>
        </div>
        
        <div class="category">
            <button class="circle-button circle-button-lightmode">
                <a href="{{ url_for('history') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-120q-138 0-240.5-91.5T122-440h82q14 104 92.5 172T480-200q117 0 198.5-81.5T760-480q0-117-81.5-198.5T480-760q-69 0-129 32t-101 88h110v80H120v-240h80v94q51-64 124.5-99T480-840q75 0 140.5 28.5t114 77q48.5 48.5 77 114T840-480q0 75-28.5 140.5t-77 114q-48.5 48.5-114 77T480-120Zm112-192L440-464v-216h80v184l128 128-56 56Z"/></svg>
                </a>
            </button>
            <span>History</span>
        </div>
        

        <div class="category">
            <button class="circle-button circle-button-lightmode">
                <a href="{{ url_for('newitem')}}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M440-280h80v-160h160v-80H520v-160h-80v160H280v80h160v160Zm40 200q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"/></svg>
                </a>
            </button>
            <span>Add</span>
        </div>

        <div class="category"> 
            <button class="circle-button circle-button-lightmode">
                <a href="{{ url_for('setting') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm112-260q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Z"/></svg>
                </a>
            </button>
            <span>Settings</span>
        </div>
    </div>

    <div class="topfive">
        <span>Top 5 Disbursemented Items</span>
    </div>

    <div class="topused-container">
        <div class="item-card">
            <div class="img-wrapper">
                <img src="../static/ico/pen_top.webp">
                <div class="status-dot green"></div>
            </div>
            <div class="item-info">
                <span class="item-name">Pen</span>
                <span class="item-category">Stationary</span>
                <span class="item-qty">Disbursemented Amount</span>

                <button class="quick-btn">Withdraw</button>
            </div>
        </div>

        <div class="item-card">
            <div class="img-wrapper">
                <img src="../static/ico/pen_top.webp">
                <div class="status-dot yellow"></div>
            </div>
            <div class="item-info">
                <span class="item-name">Name</span>
                <span class="item-category">Category</span>
                <span class="item-qty">Disbursemented Amount</span>

                <button class="quick-btn">Withdraw</button>
            </div>
        </div>

        <div class="item-card">
            <div class="img-wrapper">
                <img src="../static/ico/pen_top.webp">
                <div class="status-dot red"></div>
            </div>
            <div class="item-info">
                <span class="item-name">Name</span>
                <span class="item-category">Category</span>
                <span class="item-qty">Disbursemented Amount</span>

                <button class="quick-btn">Withdraw</button>
            </div>
        </div>

        <div class="item-card">
            <div class="img-wrapper">
                <img src="../static/ico/pen_top.webp">
                <div class="status-dot red"></div>
            </div>
            <div class="item-info">
                <span class="item-name">Name</span>
                <span class="item-category">Category</span>
                <span class="item-qty">Disbursemented Amount</span>

                <button class="quick-btn">Withdraw</button>
            </div>
        </div>

        <div class="item-card">
            <div class="img-wrapper">
                <img src="../static/ico/pen_top.webp">
                <div class="status-dot red"></div>
            </div>
            <div class="item-info">
                <span class="item-name">Name</span>
                <span class="item-category">Category</span>
                <span class="item-qty">Disbursemented Amount</span>

                <button class="quick-btn">Withdraw</button>
            </div>
        </div>
    </div>


    <div class="bottom-nav">
        <div class="nav-item">
            <a href="{{ url_for('category') }}">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M200-80q-33 0-56.5-23.5T120-160v-451q-18-11-29-28.5T80-680v-120q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v120q0 23-11 40.5T840-611v451q0 33-23.5 56.5T760-80H200Zm-40-600h640v-120H160v120Zm200 280h240v-80H360v80Z"/></svg>
            </a>
            <span class="action1">Stock</span>
        </div>

        <div id="qr-scan" class="nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M80-680v-200h200v80H160v120H80Zm0 600v-200h80v120h120v80H80Zm600 0v-80h120v-120h80v200H680Zm120-600v-120H680v-80h200v200h-80ZM700-260h60v60h-60v-60Zm0-120h60v60h-60v-60Zm-60 60h60v60h-60v-60Zm-60 60h60v60h-60v-60Zm-60-60h60v60h-60v-60Zm120-120h60v60h-60v-60Zm-60 60h60v60h-60v-60Zm-60-60h60v60h-60v-60Zm240-320v240H520v-240h240ZM440-440v240H200v-240h240Zm0-320v240H200v-240h240Zm-60 500v-120H260v120h120Zm0-320v-120H260v120h120Zm320 0v-120H580v120h120Z"/></svg>
            <span class="action2">QR Scan</span>
        </div>

        <div class="nav-item">
            {% if current_user.IsM_admin %}
                <a href="{{ url_for('adminlist') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
                        <path d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Z"/>
                    </svg>
                </a>
                <span class="action3">Manage Admin</span>
            {% else %}
            <!-- เอา def contact มาแทนด้วย + เปลี่ยน icon -->
                <a href="{{ url_for('adminlist')}}">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
                        <path d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Z"/>
                    </svg>
                </a>
                <span class="action3">Admin Contact</span>
            {% endif %}
        </div>
    </div>
    <script src="../templates/js/language.js"></script>   

    <!-- pwa service-worker js -->
    <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("{{ url_for('static', filename='service-worker.js') }}")
        .then(reg => console.log("Service Worker registered", reg))
        .catch(err => console.error("SW registration failed", err));
        }
    </script>
    
</body>
</html>

<script>
    let darkmode = localStorage.getItem('darkmode');
    const themeSwitch = document.getElementById('theme-switch');
    const circleButtons = document.querySelectorAll('.circle-button');

    const enableDarkmode = () => {
        document.body.classList.replace('lightmode', 'darkmode');
        localStorage.setItem('darkmode', 'active');
        circleButtons.forEach(button => {
            button.classList.replace('circle-button-lightmode', 'circle-button-darkmode');
        })
    }

    const disableDarkmode = () => {
        document.body.classList.replace('darkmode', 'lightmode');
        localStorage.setItem('darkmode', null);
        circleButtons.forEach(button => {
            button.classList.replace('circle-button-darkmode', 'circle-button-lightmode');
        })
    }

    if(darkmode === "active") enableDarkmode()

    themeSwitch.addEventListener("click", () => {
        darkmode = localStorage.getItem('darkmode')
        darkmode !== "active" ? enableDarkmode() : disableDarkmode()
    })

    const logoutButton = document.querySelector('#logout')
    logoutButton.addEventListener("click", (event) => {
        event.preventDefault();
        window.location.href = "logout";
    });
</script>
